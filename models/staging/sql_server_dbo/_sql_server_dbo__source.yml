version: 2

sources:
  - name: sql_server_dbo # Nombre del origen (lopuedes personalizar)
    database: ALUMNO5_DEV_BRONZE_DB # Nombre de la base de datos
    schema: sql_server_dbo # Nombre del esquema, reemplázalo con el nombre correcto de tu esquema

    quoting:
      database: false
      schema: false
      identifier: false

    freshness:
      warn_after: { count: 24, period: hour } # Si no se actualiza en 24 horas, te advierte
      error_after: { count: 72, period: hour } # Si no se actualiza en 48 horas, marca como error

    tables:
      - name: addresses
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: ADDRESS_ID
            tests:
              - unique
              - not_null
          - name: ZIPCODE
            tests:
              - numeric
              - not_null
              - accepted_values:
                  values: [1000, 2000, 3000, 4000] # Sustituir con valores válidos si están definidos
          - name: COUNTRY
            tests:
              - not_null
              - accepted_values:
                  values: ["USA", "CANADA", "MEXICO"] # Ajustar según los países esperados
          - name: ADDRESS
            tests:
              - not_null
          - name: STATE
            tests:
              - not_null
              - accepted_values:
                  values: ["CA", "NY", "TX", "FL"] # Cambiar por los estados esperados
          - name: _FIVETRAN_DELETED
            tests:
              - not_null
              - accepted_values:
                  values: [true, false]
          - name: _FIVETRAN_SYNCED
            tests:
              - not_null
              - datetime

      - name: events
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: EVENT_ID
            tests:
              - unique
              - not_null
          - name: PAGE_URL
            tests:
              - not_null
          - name: EVENT_TYPE
            tests:
              - not_null
              - accepted_values:
                  values: ['click', 'view', 'purchase', 'signup']  # Ajusta según los tipos válidos de eventos.
          - name: USER_ID
            tests:
              - not_null
          - name: PRODUCT_ID
            tests:
              - not_null
          - name: SESSION_ID
            tests:
              - not_null
          - name: CREATED_AT
            tests:
              - not_null
              - datetime
          - name: ORDER_ID
            tests:
              - unique  # Si un evento puede tener un único ORDER_ID asociado.
          - name: _FIVETRAN_DELETED
            tests:
              - not_null
              - accepted_values:
                  values: [true, false]
          - name: _FIVETRAN_SYNCED
            tests:
              - not_null
              - datetime
      

      - name: orders
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: ORDER_ID
          - name: SHIPPING_SERVICE
          - name: SHIPPING_COST
          - name: ADDRESS_ID
          - name: CREATED_AT
          - name: PROMO_ID
          - name: ESTIMATED_DELIVERY_AT
          - name: ORDER_COST
          - name: USER_ID
          - name: ORDER_TOTAL
          - name: DELIVERED_AT
          - name: TRACKING_ID
          - name: STATUS
          - name: _FIVETRAN_DELETED
          - name: _FIVETRAN_SYNCED

      - name: order_items
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: ORDER_ID
          - name: PRODUCT_ID
          - name: QUANTITY
          - name: _FIVETRAN_DELETED
          - name: _FIVETRAN_SYNCED

      - name: products
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: PRODUCT_ID
          - name: PRICE
          - name: NAME
          - name: INVENTORY
          - name: _FIVETRAN_DELETED
          - name: _FIVETRAN_SYNCED

      - name: promos
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: PROMO_ID
          - name: DISCOUNT
          - name: STATUS
          - name: _FIVETRAN_DELETED
          - name: _FIVETRAN_SYNCED

      - name: users
        loaded_at_field: _FIVETRAN_SYNCED
        columns:
          - name: USER_ID
          - name: UPDATED_AT
          - name: ADDRESS_ID
          - name: LAST_NAME
          - name: CREATED_AT
          - name: PHONE_NUMBER
          - name: TOTAL_ORDERS
          - name: FIRST_NAME
          - name: EMAIL
          - name: _FIVETRAN_DELETED
          - name: _FIVETRAN_SYNCED
